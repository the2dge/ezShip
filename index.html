<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ezShip TEST</title>
</head>
<body>
    <h3>SHIPPING ADDRESS</h3>   
<input type="text" id="shippingAddress" name="shippingAddress" readonly>
    <iframe id="appsScriptIframe" style="padding: 0; margin: 0;height: 600px; width: 100%" src="https://script.google.com/macros/s/AKfycbywiCkfH_8McvqaHS22v-dgRd5t2wKVGxHqBwC6mMHE0Xdi7VeWzpaB5MzKpe1oRRs/exec"></iframe>
   <script> 
       // Listen for messages from the ezShip return page
        window.addEventListener('message', function(event) {
            if (event.origin === window.location.origin) {
                handleEzShipReturn(event.data);
            }
        }, false);
       // Handle the return data from ezShip
        function handleEzShipReturn(data) {
            try {
                const shippingAddress = `${data.stName}, ${data.stAddr}, ${data.stCate} ${data.stCode}`;
                document.getElementById("shippingAddress").value = shippingAddress;
            } catch (error) {
                console.error("Error in handleEzShipReturn:", error);
            }
        } </script>
</body>
</html>
